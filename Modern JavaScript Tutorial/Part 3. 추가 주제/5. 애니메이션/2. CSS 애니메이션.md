# CSS 애니메이션

CSS 애니메이션을 사용하면 자바스크립트 없이도 간단한 애니메이션을 만들 수 있다.

여기에 자바스크립트를 더하면 CSS 애니메이션을 조정할 수 있고, 짧은 코드로도 훨씬 더 효과적인 애니메이션을 만들 수 있다.

## CSS 트랜지션

CSS 트랜지션이 나온 배경은 단순하다. 애니메이션 관련 프로퍼티를 만들고, 프로퍼티 값을 통해 애니메이션 효과를 정의해보자는 데서 출발했다. 프로퍼티가 변하면 브라우저는 자동으로 프로퍼티 값에 해당하는 애니메이션을 화면에 보여주자는 의도이다.

따라서 개발자는 값만 변경하면 된다. 프로퍼티 값이 변경되면 자연스러운 트랜지션(전환) 효과는 브라우저가 알아서 처리해준다.

예시를 살펴보자. 아래 CSS를 적용하면 3초 동안 `background-color`가 서서히 변한다.

```css
.animated {
  transition-property: background-color;
  transition-duration: 3s;
}
```

이 CSS를 적용하면 `animated` 클래스 속성이 있는 요소의 `background-color`가 3초 동안 변하게 된다.

다른 예시를 살펴보자. 버튼을 클릭하면 버튼 배경색이 변한다.

```html
<button id="color">클릭</button>

<style>
  #color {
    transition-property: background-color;
    transition-duration: 3s;
  }
</style>

<script>
  color.onclick = function() {
    this.style.backgroundColor = 'red';
  };
</script>
```

CSS 트랜지션에 사용되는 프로퍼티는 네 가지다.

- `transition-property`
- `transition-duration`
- `transition-timing-function`
- `transition-delay`

각 프로퍼티에 대해서는 잠시 후에 다룰 예정이다. 지금은 `transition`이라는 공통 프로퍼티를 사용해 이 네 프로퍼티를 한 번에 선언할 수 있다는 사실 정도만 알아두자. `transition` 프로퍼티에 값을 넣어주면 이 값은 `property`, `duration`, `timing-function`, `delay` 프로퍼티에 각각 할당되고, 애니메이션 효과는 한 번에 적용된다.

아래와 같이 `transition` 프로퍼티를 정의하면 `font-size`는 3초 동안, `color`는 2초 동안 변화하는 것을 확인할 수 있다.

```html
<button id="growing">클릭</button>

<style>
#growing {
  transition: font-size 3s, color 2s;
}
</style>

<script>
growing.onclick = function() {
  this.style.fontSize = '36px';
  this.style.color = 'red';
};
</script>
```

이제 본격적으로 각 프로퍼티를 살펴보자.

## transition-property

`transition-property` 프로퍼티엔 `left`, `margin-left`, `height`, `color` 같이 애니메이션 효과를 적용할 프로퍼티 목록을 정의한다.

이때 주의할 점은 모든 프로퍼티에 애니메이션 효과를 적용할 수 없다는 사실이다. 참고로 [흔히 사용되는 프로퍼티 대다수엔](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_animated_properties) 애니메이션 효과를 적용할 수 있다.

## transition-duration

`transition-duration` 프로퍼티엔 애니메이션 효과를 얼마 동안 줄지를 설정한다. 시간은 [CSS 시간 형식(CSS time format)](http://www.w3.org/TR/css3-values/#time)을 따라야 하는데, 초 단위(`s`)나 밀리초 단위(`ms`)를 사용할 수 있다.

## transition-delay

`transition-delay` 프로퍼티엔 애니메이션 효과가 *시작되기 전*에 얼마만큼의 지연 시간을 줄지 설정한다. `transition-delay` 값을 `1s`로 설정하면 애니메이션 효과가 1초 후에 나타난다.

`transition-delay`엔 음수 값도 넣을 수 있다. 값이 음수일 땐 애니메이션 효과가 중간부터 나타난다. `transition-duration`을 `2s`, 지연 시간을 `-1s`로 설정하면 애니메이션 효과는 1초가 지난 후 1초 동안 지속된다.

CSS `translate` 프로퍼티와 지금까지 배운 내용을 사용해 `0`부터 `9`까지가 화면에 자연스럽게 나타나도록 해보겠다.

script.js:

```js
stripe.onclick = function() {
  stripe.classList.add('animate');
};
```

style.css:

```css
#digit {
  width: .5em;
  overflow: hidden;
  font: 32px monospace;
  cursor: pointer;
}

#stripe {
  display: inline-block
}

#stripe.animate {
  transform: translate(-90%);
  transition-property: transform;
  transition-duration: 9s;
  transition-timing-function: linear;
}
```

index.html:

```html
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  아래 숫자를 클릭하세요.

  <div id="digit"><div id="stripe">0123456789</div></div>

  <script src="script.js"></script>
</body>

</html>
```

참고로 숫자를 왼쪽으로 이동시키기 위해 `transform` 프로퍼티에 translate(-90%)를 넣었다.

```css
#stripe.animate {
  transform: translate(-90%);
  transition-property: transform;
  transition-duration: 9s;
}
```

숫자를 클릭하면 자바스크립트가 실행되면서 숫자가 들어 있는 요소(stripe)에 `animate` 클래스가 추가되고 애니메이션 효과가 나타난다.

```js
stripe.classList.add('animate');
```

이번엔 `transition-delay`에 음수를 써서 예시를 약간 변형해보자. 현재 시각을 기준으로 '초’를 추출하고, 이 값에 마이너스 기호를 붙여서 `transition-delay` 값으로 지정하면 현재 초를 기준으로 숫자가 나타나고, 애니메이션 효과가 적용되는 것을 확인할 수 있다.

직접 숫자를 클릭해보자. 현재 날짜가 2024년 5월 13일 오후 15시 43분 8초라면, 숫자 8부터 스르륵 이동한다.

script.js:

```js
stripe.onclick = function() {
  let sec = new Date().getSeconds() % 10;
  stripe.style.transitionDelay = '-' + sec + 's';
  stripe.classList.add('animate');
};
```

style.css:

```css
#digit {
  width: .5em;
  overflow: hidden;
  font: 32px monospace;
  cursor: pointer;
}

#stripe {
  display: inline-block
}

#stripe.animate {
  transform: translate(-90%);
  transition-property: transform;
  transition-duration: 9s;
  transition-timing-function: linear;
}
```

index.html:

```html
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  아래 숫자를 클릭하세요.
  <div id="digit"><div id="stripe">0123456789</div></div>

  <script src="script.js"></script>
</body>
</html>
```

사용한 코드는 아래와 같다.

```js
stripe.onclick = function() {
  let sec = new Date().getSeconds() % 10;
  // sec가 3이라면 transitionDelay 값이 -3s가 되어 3부터 애니메이션 효과가 적용됩니다.
  stripe.style.transitionDelay = '-' + sec + 's';
  stripe.classList.add('animate');
};
```

## transition-timing-function

`transition-timing-function` 프로퍼티를 사용해 timing 함수를 만들면 시간에 따라 애니메이션 효과를 어떻게 분배할지를 설정할 수 있다. 애니메이션 효과가 초반엔 천천히 나타나다가 나중엔 빠르게 나타나게 할 수 있고, 물론 이 반대도 가능하다.

처음 이 프로퍼티를 접하면 애니메이션 프로퍼티 중 가장 복잡한 프로퍼티 같다고 느낄 수 있다. 그렇지만 시간을 조금 투자해 학습하면 매우 간단한 프로퍼티라는 생각이 들 것이다.

`transition-timing-function` 프로퍼티 값엔 베지어 곡선(bezier curve)이나 단계(step)가 올 수 있다. 먼저 사용 빈도가 높은 베지어 곡선부터 알아보자.

### 베지어 곡선

`transition-timing-function`엔 조절점이 4개면서 아래 조건을 만족하는 [베지어 곡선](https://ko.javascript.info/bezier-curve)을 지정할 수 있다.

1. 첫 번째 조절점: `(0,0)`
2. 마지막 조절점: `(1,1)`
3. 중간 조절점들: `x`가 `0`과 `1` 사이에 있어야 함. `y`엔 제약이 없음

CSS에선 베지어 곡선을 `cubic-bezier(x2, y2, x3, y3)`형태로 정의한다. 규칙에 따라 첫 번째 조절점은 `(0,0)`, 네 번째 조절점은 `(1,1)`로 고정되므로 두 번째와 세 번째 조절점만 설정하면 된다.

조절점을 변경해 만든 베지어 곡선을 사용해 정의한 timing 함수는 시간이 지남에 따라 얼마나 빠르게 애니메이션 효과가 나타나게 할지를 보여준다.

- `x`축은 시간이 된다. `0`은 애니메이션 시작하는 시간, `1`은 끝나는 시간을 나타낸다.
- `y`축은 프로세스 완성 정도를 나타낸다. `0`은 프로퍼티 시작 값, `1`은 최종값을 나타낸다.

가장 간단한 timing 함수를 적용하면 애니메이션 효과가 일정한 속도로 나타난다. `cubic-bezier(0, 0, 1, 1)`를 사용해 기울기가 1인 직선형 함수를 만들어보자.

베지어 곡선이 이렇게 그려진다.

<img src="https://ko.javascript.info/article/css-animations/bezier-linear.svg" alt="" width="144" height="150">

보다시피 그냥 직선이다. 시간(`x`)이 지나면서 애니메이션의 완성도(`y`)가 `0`에서 `1`로 꾸준히 올라간다.

이제 아래 기차를 클릭해, 기차가 일정한 속도로 왼쪽에서 오른쪽으로 이동하게 해보자.

style.css:

```css
.train {
  position: relative;
  cursor: pointer;
  width: 177px;
  height: 160px;
  left: 0;
  transition: left 5s cubic-bezier(0, 0, 1, 1);
}
```

index.html:

```html
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <img class="train" src="https://js.cx/clipart/train.gif" onclick="this.style.left='450px'">

</body>

</html>
```

실제 사용한 스타일은 다음과 같다.

```css
.train {
  left: 0;
  transition: left 5s cubic-bezier(0, 0, 1, 1);
  /* left 속성값(450px)은 자바스크립트에서 설정함 */
}
```

이제 기차가 점점 느리게 이동하도록 만들어보자.

다른 베지어 곡선 `cubic-bezier(0.0, 0.5, 0.5 ,1.0)`을 사용해서 말이다.

새로운 베지어 곡선은 다음과 같다.

<img src="https://ko.javascript.info/article/css-animations/train-curve.svg" alt="" width="149" height="187">

그래프에서 볼 수 있듯이 프로세스는 초반에 빠르게 진행되다가 점점 느려질 것이다.

기차를 클릭해 실제 timing 함수가 어떻게 적용되었는지 확인해보자.

style.css:

```css
.train {
  position: relative;
  cursor: pointer;
  width: 177px;
  height: 160px;
  left: 0px;
  transition: left 5s cubic-bezier(0.0, 0.5, 0.5, 1.0);
}
```

index.html:

```html
<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <img class="train" src="https://js.cx/clipart/train.gif" onclick="this.style.left='450px'">

</body>

</html>
```

CSS:

```css
.train {
  left: 0;
  transition: left 5s cubic-bezier(0, .5, .5, 1);
    /* left 속성값(450px)은 자바스크립트에서 설정함 */
}
```

직접 베지어 곡선을 만드는 것 말고, 내장 곡선을 사용할 수도 있다. 내장 곡선엔 `linear`, `ease`, `ease-in`, `ease-out`, `ease-in-out` 등이 있다.

`linear`는 위에서 본 직선 형태의 timing 함수를 쓸 때 사용된 `cubic-bezier(0, 0, 1, 1)`와 동일한 효과를 준다.

각 내장 곡선에 대응하는 베지어 곡선은 다음과 같다.

| `ease`*                                                                                                | `ease-in`                                                                                                 | `ease-out`                                                                                                 | `ease-in-out`                                                                                                 |
| ------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| `(0.25, 0.1, 0.25, 1.0)`                                                                               | `(0.42, 0, 1.0, 1.0)`                                                                                     | `(0, 0, 0.58, 1.0)`                                                                                        | `(0.42, 0, 0.58, 1.0)`                                                                                        |
| <img src="https://ko.javascript.info/article/css-animations/ease.svg" alt="" width="149" height="187"> | <img src="https://ko.javascript.info/article/css-animations/ease-in.svg" alt="" width="149" height="187"> | <img src="https://ko.javascript.info/article/css-animations/ease-out.svg" alt="" width="149" height="187"> | <img src="https://ko.javascript.info/article/css-animations/ease-in-out.svg" alt="" width="149" height="187"> |

`*`로 표시한 내장 곡선 `ease`는 timing 함수가 없을 때 기본값으로 사용된다.

이제 `ease-out`을 사용해 기차가 점점 느려지도록 해보자.

```css
.train {
  left: 0;
  transition: left 5s ease-out;
  /* transition: left 5s cubic-bezier(0, .5, .5, 1); */
}
```

베지어 곡선 `cubic-bezier(0.0, 0.5, 0.5 ,1.0)`을 사용한 것처럼 기차가 점점 느려지긴 하지만 프로세스 정도가 조금 다른 것을 확인할 수 있다.

한편, **베지어 곡선을 사용하면 애니메이션이 지정한 범위를 ‘넘어서’ 적용되게 할 수 있다.**

베지어 곡선에서 중간 조절점의 `y` 좌표는 제약이 없다. 음수 또는 매우 큰 값도 가능하다. 그런데 조절점의 `y` 좌표가 음수 또는 큰 값일 때 베지어 곡선은 매우 낮거나 높게 그려진다. 이러면 애니메이션이 정상 범위를 벗어난다.

아래쪽 기차 예시에 다음과 같은 css를 적용했다고 가정해보자.

```css
.train {
  left: 100px;
  transition: left 5s cubic-bezier(.5, -1, .5, 2);
    /* left 속성값(400px)은 자바스크립트에서 설정함 */
}
```